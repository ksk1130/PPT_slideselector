# PowerPoint VBAアドイン セットアップガイド

## 最も簡単なセットアップ方法（5分で完了）

### ステップ 1: PowerPointを開く

### ステップ 2: VBAエディタを開く
```
Alt + F11
```

### ステップ 3: モジュールを作成
1. 左側の「プロジェクト」ウィンドウで、プレゼンテーションを右クリック
2. `挿入` → `モジュール` を選択

### ステップ 4: コードをコピー
**COMPLETE_CODE.txt** の「モジュール部分」のコードをコピーして、
VBAエディタのモジュールに貼り付け

### ステップ 5: ユーザーフォームを作成
1. 左側の「プロジェクト」ウィンドウで、プレゼンテーションを右クリック
2. `挿入` → `ユーザーフォーム` を選択
3. フォーム名を `UserFormSlideSelector` に変更
4. 次のコントロールを追加：

#### コントロール配置図
```
┌─────────────────────────────────────┐
│  スライド選択                          │
├─────────────────────────────────────┤
│  [ListBox: lstSlides]               │
│  ┌─────────────────────────────────┐│
│  │ スライド 1 - タイトル            ││
│  │ スライド 2 - タイトル            ││
│  │ スライド 3 - タイトル            ││
│  │ ...                              ││
│  └─────────────────────────────────┘│
├─────────────────────────────────────┤
│  [ジャンプ]      [キャンセル]       │
└─────────────────────────────────────┘
```

#### コントロール詳細
| コントロール | プロパティ | 値 |
|-------------|-----------|-----|
| ListBox | Name | lstSlides |
| | Top | 20 |
| | Left | 10 |
| | Width | 260 |
| | Height | 160 |
| Button | Name | cmdJump |
| | Caption | ジャンプ |
| | Top | 190 |
| | Left | 10 |
| | Width | 120 |
| Button | Name | cmdCancel |
| | Caption | キャンセル |
| | Top | 190 |
| | Left | 150 |
| | Width | 120 |

### ステップ 6: ユーザーフォームのコードを追加
**COMPLETE_CODE.txt** の「ユーザーフォーム部分」のコードをコピーして、
ユーザーフォーム（UserFormSlideSelector）のコードウィンドウに貼り付け

### ステップ 7: テスト
1. PowerPointのVBAエディタで `Ctrl + S` で保存
2. VBAエディタを閉じる
3. イミディエイトウィンドウでテスト（または直接実行）

---

## 実行方法

### 方法1: VBAエディタから
1. `Alt + F11` でVBAエディタを開く
2. イミディエイトウィンドウ（`Ctrl + G` で表示）に以下を入力：
   ```
   ShowSlideDialog
   ```
3. Enter キーを押す

### 方法2: ボタンから実行
PowerPointのリボンにボタンを追加します：

1. PowerPointの `ファイル` → `オプション` → `リボンのユーザー設定`
2. 右側の「新しいグループ」をクリック
3. 新しいグループを選択して「新しいタブ」で新規作成
4. 左側の「コマンドの選択」から「マクロ」を選択
5. `Project.Module1.ShowSlideDialog` を選択して追加
6. `表示名` を「スライド選択」などに変更
7. OK をクリック

これでリボンにボタンが追加され、ワンクリックで機能が実行できます

---

## 使用方法

### 基本操作
1. ボタンをクリック（またはマクロを実行）
2. ダイアログが表示
3. スライドをリストから選択
4. `[ジャンプ]` ボタンをクリック（またはダブルクリック）
5. 選択したスライドへジャンプ

### 注意
- **スライドショー実行中** - GotoSlide で選択スライドに遷移
- **通常編集画面** - スライドショーを開始して指定スライドから開始

---

## よくある質問

### Q: マクロが実行できません
**A:** PowerPointのマクロセキュリティ設定を確認してください
- `ファイル` → `オプション` → `セキュリティセンター` → `セキュリティセンターの設定`
- `マクロの設定` で「警告を表示してマクロを無効にする」を選択

### Q: ユーザーフォームが表示されません
**A:** コード記述時にエラーがないか確認してください
- VBAエディタの `デバッグ` → `コンパイルVBAプロジェクト` で確認

### Q: スライド数が多い場合、リスト表示が遅い
**A:** これは正常な動作です。最適化が必要な場合は、キャッシュ機能を追加できます

---

## トラブルシューティング

| 問題 | 解決方法 |
|------|--------|
| エラー: "ユーザーフォームが見つかりません" | ユーザーフォーム名が正しいか確認（`UserFormSlideSelector`） |
| ダイアログが開かない | VBAコンパイルエラーがないか確認 |
| ジャンプが機能しない | スライドショーが実行中か確認 |
| コントロールが表示されない | コントロールのプロパティ（Left, Top, Width, Height）を確認 |

---

## 次のステップ

### カスタマイズ例

**1. スライド検索機能を追加**
```vba
Private Sub txtSearch_Change()
    ' テキストボックスに入力されたテキストで検索
End Sub
```

**2. スライドプレビューを表示**
```vba
' ユーザーフォームに Image コントロールを追加
' 選択時にスライドのサムネイル画像を表示
```

**3. スライドソート**
```vba
' リストを時系列でソート
lstSlides.ListIndex = 0
```

詳細については、PowerPointのVBA APIリファレンスを参照してください。
